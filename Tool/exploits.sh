#!/bin/bash

NC=$(tput setaf 0)
RED=$(tput setaf 1)
GREEN=$(tput setaf 2)
YELLOW=$(tput setaf 3)
BLUE=$(tput setaf 4)
MAGENTA=$(tput setaf 5)
CYAN=$(tput setaf 6)
WHITE=$(tput setaf 7)

# add file log
msfconsole --no-rlwrap --quiet > "/tmp/exploit.log"
echo "													"
####### Welcome User
echo -e "			${BLUE}Welcome back : \n${NC}"

read -p $'\033[0;34mEnter \033[1;34mplatform \033[1;33m(Android or Windows or Linux or iOS) : \033[1;34m' platform

# Convert the input to lowercase
platform=$(echo "$platform" | tr '[:upper:]' '[:lower:]')

case $platform in
    "android") platform="Android" ;;
    "windows") platform="Windows" ;;
    "linux") platform="Linux" ;;
    "ios") platform="iOS" ;;
    "a") platform="Android" ;;
    "w") platform="Windows" ;;
    "l") platform="Linux" ;;
    "i") platform="iOS" ;;
    *) echo "Invalid platform input." ; exit 1 ;;
esac


echo "													"

read -p $'\033[0;34mEnter \033[1;34myear \033[1;33m(optional) : \033[1;34m' Year

echo "													"

read -p $'\033[0;34mDo you know the \033[1;34mdescription \033[1;33mof a specific EXPLOIT (optional) : \033[1;34m' description

echo "													"

read -p $'\033[0;34mDo you want a \033[1;34mspecific .. \033[1;33m(interactive OR Non_interactive) OR Enter Skip : \033[1;34m' Tag

echo "													"

read -p $'\033[0;34mDo you want a \033[1;34mRank .. \033[1;33m(good OR excellent OR normal OR manual) OR Enter Skip : \033[1;34m' Rank

# Build query string
query=""

if [ ! -z "$Year" ]; then
  query+=" date:$Year"
fi

if [ ! -z "$description" ]; then
  query+=" description:$description"
else
  query=""
fi

if [ ! -z "$Rank" ]; then
  query+=" Rank:$Rank"
fi

if [ ! -z "$Tag" ]; then
  query+=" $Tag"
fi


# Print search criteria
echo -e "\e[1;36mSearching for exploits with the following criteria:$query $NC"

# Execute the search
msfconsole -x "search type:exploit platform:$platform '$query'"

rm /tmp/exploit.log
